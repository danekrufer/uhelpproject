server {
    listen 80;

    # Корень — папка /usr/share/nginx/html
    root /usr/share/nginx/html;

    # Индексный файл — public/index.html
    index public/index.html;

    location / {
        # Ищем файлы в таком порядке:
        # 1. Сначала в public (по полному пути)
        # 2. Потом в корне
        # 3. Если не найдено — отдаём public/index.html
        try_files public/$uri $uri /public/index.html;
    }

    # Обработка статических файлов в assets
    location /assets/ {
        # Важно: alias должен заканчиваться на /
        alias /usr/share/nginx/html/assets/;
        
        # Отключаем логирование для статики
        access_log off;
        
        # Включаем кэширование на 30 дней
        expires 30d;
        add_header Cache-Control "public, no-transform";
        
        # Если файла нет — 404
        try_files $uri =404;
    }

    # Блокируем доступ к скрытым файлам
    location ~ /\. {
        deny all;
        return 404;
    }
}